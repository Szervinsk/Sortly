<!DOCTYPE html>
<html lang="pt-br" class="h-full bg-gray-100">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sortly - Prefer√™ncias</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
  </head>
  <body class="h-full flex font-sans">
    <aside
      class="w-64 bg-white border-r border-gray-200 hidden md:flex flex-col"
    >
      <div class="p-6 h-20 flex items-center border-b border-gray-100">
        <i class="ph ph-books text-3xl text-blue-600 mr-3"></i>
        <span class="text-xl font-bold text-gray-800">Sortly</span>
      </div>

      <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
        <a
          href="/"
          class="flex items-center px-4 py-3 text-gray-600 rounded-lg transition-colors hover:bg-gray-100 hover:text-gray-900"
        >
          <i class="ph ph-house mr-3 text-lg"></i> Home
        </a>

        <a
          href="/history"
          class="flex items-center px-4 py-3 text-gray-600 rounded-lg transition-colors hover:bg-gray-100 hover:text-gray-900"
        >
          <i class="ph ph-tray mr-3 text-lg"></i> Emails Processados
        </a>

        <div
          class="text-xs font-semibold text-gray-400 uppercase tracking-wider mt-8 mb-2 px-4"
        >
          Configura√ß√µes
        </div>

        <a
          href="/preferences"
          class="flex items-center px-4 py-3 rounded-lg transition-colors bg-blue-50 text-blue-600 font-medium"
        >
          <i class="ph ph-gear mr-3 text-lg"></i> Prefer√™ncias
        </a>
      </nav>
    </aside>

    <main class="flex-1 flex flex-col overflow-hidden">
      <header
        class="bg-white border-b border-gray-200 h-20 flex items-center justify-between px-8"
      >
        <div class="flex items-center text-sm text-gray-500">
          <i class="ph ph-gear mr-2"></i> Configura√ß√µes /
          <span class="text-gray-800 ml-2 font-medium">API Key</span>
        </div>
      </header>

      <div class="flex-1 overflow-y-auto p-8 bg-gray-100">
        <div class="max-w-3xl mx-auto">
          <div
            class="bg-white p-8 rounded-2xl border border-gray-200 shadow-sm"
          >
            <div class="mb-6">
              <h2 class="text-xl font-bold text-gray-900 mb-2">
                Configura√ß√£o da IA
              </h2>
              <p class="text-gray-500 text-sm">
                Insira sua pr√≥pria chave da API do Google Gemini para ter
                controle total sobre o uso.
              </p>
            </div>

            <form id="prefForm" class="space-y-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Sua Google Gemini API Key</label
                >
                <div class="relative">
                  <input
                    type="password"
                    id="api-key-input"
                    class="block w-full rounded-xl border-gray-300 shadow-sm p-4 pr-12 text-gray-700 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 border"
                    placeholder="Ex: AIzaSyD..."
                  />
                  <button
                    type="button"
                    onclick="toggleVisibility()"
                    class="absolute inset-y-0 right-0 px-4 text-gray-400 hover:text-gray-600"
                  >
                    <i id="eye-icon" class="ph ph-eye text-xl"></i>
                  </button>
                </div>
                <p class="text-xs text-gray-400 mt-2">
                  A chave ser√° salva apenas no seu navegador.
                  <a
                    href="https://aistudio.google.com/app/apikey"
                    target="_blank"
                    class="text-blue-600 hover:underline"
                    >Obter chave aqui.</a
                  >
                </p>
              </div>

              <div class="flex items-center justify-end pt-4">
                <button
                  type="submit"
                  class="flex items-center py-3 px-6 rounded-xl shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 transition-all"
                >
                  <i class="ph ph-floppy-disk mr-2 text-xl"></i> Salvar
                  Configura√ß√µes
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>

    <script>
      // Carregar chave salva ao abrir a p√°gina
      document.addEventListener("DOMContentLoaded", () => {
        const savedKey = localStorage.getItem("sortly_gemini_key");
        if (savedKey) {
          document.getElementById("api-key-input").value = savedKey;
        }
      });

      // Salvar chave
      document.getElementById("prefForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const key = document.getElementById("api-key-input").value.trim();

        if (key) {
          localStorage.setItem("sortly_gemini_key", key);
          alert(
            "‚úÖ Chave salva com sucesso! Agora suas an√°lises usar√£o sua API Key."
          );
        } else {
          localStorage.removeItem("sortly_gemini_key");
          alert(
            "üóëÔ∏è Chave removida. O sistema tentar√° usar a chave padr√£o do servidor."
          );
        }
      });

      // Toggle Password Visibility
      function toggleVisibility() {
        const input = document.getElementById("api-key-input");
        const icon = document.getElementById("eye-icon");
        if (input.type === "password") {
          input.type = "text";
          icon.classList.replace("ph-eye", "ph-eye-slash");
        } else {
          input.type = "password";
          icon.classList.replace("ph-eye-slash", "ph-eye");
        }
      }
    </script>
  </body>
</html>
